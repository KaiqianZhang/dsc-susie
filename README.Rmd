# dsc-susie

## Goal

This is a Dynamic Statistical Comparison for testing SuSiE performance given a design matrix `X` from real data, e.g. GTEx, single cell, or GSEA data.

Our intention is to investigate if SuSiE has a good interpretation (i.e. high power, low false discovery rate) in the context of different X structures.

## Data 

### GTEx data

  - GTEx data are from two tissues: whole blood and brain cells. i.e. design matrix `X` is real genotype data from 755 whole blood and 439 brain cell samples on 1000 genes. 

### Single cell data

  - Single cell data consist of two types of hard-to-distinguished cells. i.e. design matrix `X` has 600 regulatory T cells and 600 memory T cells on 1000 genes.

### GSEA data

  - GSEA data have genes as rows and pathways as columns. i.e. design matrix `X` has 1200 genes on 1000 pathways.

### Random data

  - Random data are a 1200 by 1000 matrix, each entry of which is randomly generated from rnorm(0,1).

We simulate 50 datasets. For each dataset, we simulate a gaussian `y` under various circumstances for different questions of interest. For instance, we set different priors to investigate whether SuSiE has a better performance when the number of nonzero effects is sparse. 

## Performance evaluation criteria

We evaluate SuSiE performance by the following four numerical values:

  - power: 
          # of confidence sets that contain at least one true effect / # of true effects
  
  - fdr: false discovery rate
         1 - # of confidence sets that contain at least one true effect / # of confidence sets
  
  - cs_size: median size of confidence sets
  
  - cs_num: number of confidence sets
  
  - top hit rate: a top hit means that when a confidence set contains a true effect, if the true effect has the highest posterior inclusion probability(PIP), we count it as a top hit. 
    top hit rate = # of top hit / # of confidence sets.
    
  - avg_purity: 

## Questions to investigate

  - How is power under different PVEs?

  - How to set a prior given only one nonzero effect?

  - How is SuSiE power given different number of nonzero effects?

  - How to set a prior given two nonzero effects?

  - How does SuSiE perform given 200 nonzero effects?

## Input `X`

To input a customized design matrix `X`, please go to `benchmark.dsc`. At the bottom, change the `pathX` to the path of your matrix `X` as you want. 

## Run DSC

The main DSC file is `benchmarks.dsc`. To see what is available:

```
./benchmark.dsc -h
```

before running, 
```
rm -Rf benchmark.scripts.html benchmark.html benchmark

```

and to run the benchmark:

```
dsc benchmark.dsc --replicate 10
```

Or to run a minimal test benchmark, e.g.
```
dsc benchmark.dsc --truncate
```

